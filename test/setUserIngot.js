/**
 * Created by xiazhengxin on 2016/11/30.
 *
 * 补偿用户游戏币
 */

var mail = require("../code/model/mail");
var user = require("../code/model/user");
var async = require("async");
var userList = [39980105735, 39980105769, 39980105789, 39980105800, 39980105803, 39980105818, 39980105825, 39980105826, 39980105835, 39980105841, 39980105860, 39980105874, 39980105875, 39980105912, 39980105921, 39980105931, 39980105978, 39980106087, 39980106095, 39980106100, 39980106109, 39980106142, 39980106168, 39980106174, 39980106182, 39980106190, 39980106239, 39980106249, 39980106373, 39980106424, 39980106434, 39980106475, 39980106511, 39980106654, 39980106666, 39980106705, 39980106720, 39980106734, 39980106742, 39980106818, 39980106820, 39980106881, 39980107014, 39980107067, 39980107093, 39980107116, 39980107137, 39980107140, 39980107141, 39980107155, 39980107176, 39980107221, 39980107320, 39980107350, 39980107386, 39980107565, 39980107688, 39980107699, 39980107767, 39980107771, 39980107773, 39980107841, 39980107850, 39980107861, 39980107907, 39980107910, 39980107942, 39980107971, 39980108041, 39980108172, 39980108264, 39980108271, 39980108336, 39980108415, 39980108435, 39980108437, 39980108455, 39980108487, 39980108519, 39980108559, 39980108585, 39980108719, 39980108727, 39980108840, 39980108947, 39980109057, 39980109104, 39980109135, 39980109150, 39980109178, 39980109349, 39980109512, 39980109514, 39980109521, 39980109525, 39980109641, 39980109652, 39980109672, 39980109687, 39980109694, 39980109806, 39980109875, 39980109881, 39980109903, 39980110001, 39980110046, 39980110141, 39980110169, 39980110209, 39980110228, 39980110269, 39980110314, 39980110343, 39980110364, 39980110401, 39980110413, 39980110438, 39980110475, 39980110484, 39980110491, 39980110523, 39980110561, 39980110613, 39980110653, 39980110696, 39980110702, 39980110727, 39980110779, 39980110809, 39980110874, 39980110906, 39980110924, 39980110935, 39980110949, 39980111102, 39980111137, 39980111212, 39980111221, 39980111269, 39980111363, 39980111431, 39980111466, 39980111537, 39980111544, 39980111568, 39980111581, 39980111644, 39980111650, 39980111721, 39980111746, 39980111755, 39980111771, 39980111782, 39980111792, 39980111811, 39980111835, 39980111836, 39980111857, 39980111860, 39980111864, 39980111867, 39980111868, 39980111874, 39980111890, 39980111941, 39980111951, 39980111954, 39980111997];
var ingotList = [600, 600, 2888, 600, 5776, 300, 300, 600, 300, 900, 600, 300, 300, 300, 300, 900, 300, 300, 300, 900, 900, 1200, 900, 300, 3788, 900, 300, 1500, 300, 300, 300, 1200, 1200, 600, 900, 300, 300, 300, 300, 600, 300, 900, 300, 600, 300, 900, 900, 1200, 300, 1200, 1200, 600, 300, 300, 300, 1800, 900, 900, 1200, 300, 300, 900, 600, 2100, 900, 600, 1800, 300, 600, 300, 300, 900, 900, 300, 300, 300, 300, 300, 1200, 300, 300, 1500, 600, 1200, 1800, 2888, 900, 300, 600, 900, 900, 300, 300, 300, 300, 300, 600, 300, 2700, 1500, 600, 300, 600, 300, 900, 900, 300, 900, 1200, 300, 600, 300, 600, 900, 300, 300, 300, 1200, 300, 600, 900, 1500, 300, 600, 300, 600, 300, 4088, 300, 600, 300, 1200, 1200, 300, 600, 600, 900, 600, 600, 600, 300, 300, 600, 1200, 1200, 600, 300, 300, 300, 600, 300, 300, 600, 300, 300, 300, 300, 300, 300, 600, 600, 600, 300, 300, 600, 300, 300, 9564];
var i = 0;

async.forEachSeries(userList, function (userUid, cb) {
    var userData;
    async.series([function (queueCb) {
        user.getUser(userUid, function (err, res) {
            userData = res;
            queueCb(err);
        });
    }, function (queueCb) {
        user.updateUser(userUid, {"ingot": userData["ingot"] - 0 + ingotList[i]}, queueCb);
    }, function (queueCb) {
        /*
         * Dear players,
         We have fixed the gravity training issue. If you use glitch again or use the mechanics of the game to get unfair advantage, we will ban the account.
         *
         * */
        mail.addMail(userUid, "-1", "Limited Call for powerful heroes compensation.", JSON.stringify([{
            "id": "ingot",
            "count": 0
        }]), "911", queueCb);
    }], function (err, res) {
        i++;
        cb();
    });
}, function (err) {
    console.log('end', err);
    process.exit();
});